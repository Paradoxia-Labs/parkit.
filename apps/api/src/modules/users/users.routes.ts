import { Router } from "express";
import { UsersController } from "./users.controller";
import { requireAuth } from "../../shared/middleware/requireAuth";
import { requireRole } from "../../shared/middleware/requireRole";
import { validateRequest } from "../../shared/middleware/validateRequest";
import { CreateUserSchema, UpdateUserSchema } from "../../shared/validators";

const router = Router();

router.post("/", validateRequest(CreateUserSchema), requireAuth, requireRole("ADMIN", "STAFF"), UsersController.create);
router.get("/", requireAuth, requireRole("ADMIN", "STAFF"), UsersController.list);
router.get("/:id", requireAuth, requireRole("ADMIN", "STAFF"), UsersController.get);
router.patch("/:id", validateRequest(UpdateUserSchema), requireAuth, requireRole("ADMIN", "STAFF"), UsersController.update);
router.delete("/:id", requireAuth, requireRole("ADMIN", "STAFF"), UsersController.deactivate);

export default router;
